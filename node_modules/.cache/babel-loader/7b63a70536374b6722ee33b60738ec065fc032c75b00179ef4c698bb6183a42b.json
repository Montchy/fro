{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = useIMGElementState;\nvar _react = require(\"react\");\nvar _reactNative = require(\"react-native\");\nvar _defaultInitialImageDimensions = _interopRequireDefault(require(\"./defaultInitialImageDimensions\"));\nvar _useIMGNormalizedSource = _interopRequireDefault(require(\"./useIMGNormalizedSource\"));\nvar _useImageConcreteDimensions = _interopRequireDefault(require(\"./useImageConcreteDimensions\"));\nvar _getIMGState = require(\"./getIMGState\");\nvar _useImageSpecifiedDimensions = _interopRequireDefault(require(\"./useImageSpecifiedDimensions\"));\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\nfunction getImageSizeAsync({\n  uri,\n  headers\n}) {\n  return new Promise((onsuccess, onerror) => {\n    const onImageDimensionsSuccess = (width, height) => onsuccess({\n      width,\n      height\n    });\n    if (headers) {\n      _reactNative.Image.getSizeWithHeaders(uri, headers, onImageDimensionsSuccess, onerror);\n    } else {\n      _reactNative.Image.getSize(uri, onImageDimensionsSuccess, onerror);\n    }\n  });\n}\nfunction useImageNaturalDimensions(props) {\n  const {\n    source,\n    cachedNaturalDimensions\n  } = props;\n  const [naturalDimensions, setNaturalDimensions] = (0, _react.useState)(cachedNaturalDimensions || null);\n  const {\n    width: cachedNaturalWidth,\n    height: cachedNaturalHeight\n  } = cachedNaturalDimensions || {};\n  const [error, setError] = (0, _react.useState)(null);\n  (0, _react.useEffect)(function resetOnURIChange() {\n    setNaturalDimensions(cachedNaturalWidth != null && cachedNaturalHeight != null ? {\n      width: cachedNaturalWidth,\n      height: cachedNaturalHeight\n    } : null);\n    setError(null);\n  }, [cachedNaturalHeight, cachedNaturalWidth, source.uri]);\n  return {\n    onNaturalDimensions: setNaturalDimensions,\n    onError: setError,\n    naturalDimensions,\n    error\n  };\n}\nfunction useFetchedNaturalDimensions(props) {\n  const {\n    source,\n    cachedNaturalDimensions\n  } = props;\n  const {\n    error,\n    naturalDimensions,\n    onError,\n    onNaturalDimensions\n  } = useImageNaturalDimensions(props);\n  const hasCachedDimensions = !!cachedNaturalDimensions;\n  (0, _react.useEffect)(function fetchPhysicalDimensions() {\n    let cancelled = false;\n    if (source.uri && !hasCachedDimensions) {\n      getImageSizeAsync({\n        uri: source.uri,\n        headers: source.headers\n      }).then(dimensions => !cancelled && onNaturalDimensions(dimensions)).catch(e => !cancelled && onError(e || {}));\n      return () => {\n        cancelled = true;\n      };\n    }\n  }, [source.uri, source.headers, onNaturalDimensions, onError, hasCachedDimensions]);\n  return {\n    naturalDimensions,\n    error,\n    onError,\n    onNaturalDimensions\n  };\n}\n/**\n * This hook will compute concrete dimensions from image natural dimensions and\n * constraints. It will fetch the image and get its dimensions.\n *\n * @remarks If you know the dimensions beforehand, use\n * {@link useIMGElementStateWithCache} instead to save a network request and\n * prevent a layout shift.\n */\n\nfunction useIMGElementState(props) {\n  const {\n    alt,\n    altColor,\n    source,\n    contentWidth,\n    computeMaxWidth,\n    objectFit,\n    initialDimensions = _defaultInitialImageDimensions.default,\n    cachedNaturalDimensions\n  } = props;\n  const {\n    flatStyle,\n    specifiedDimensions\n  } = (0, _useImageSpecifiedDimensions.default)(props);\n  const nomalizedSource = (0, _useIMGNormalizedSource.default)({\n    specifiedDimensions,\n    source\n  });\n  const {\n    naturalDimensions,\n    onError,\n    error\n  } = useFetchedNaturalDimensions({\n    source: nomalizedSource,\n    specifiedDimensions,\n    cachedNaturalDimensions\n  });\n  const concreteDimensions = (0, _useImageConcreteDimensions.default)({\n    flatStyle,\n    naturalDimensions,\n    specifiedDimensions,\n    computeMaxWidth,\n    contentWidth\n  });\n  return (0, _getIMGState.getIMGState)({\n    error,\n    alt,\n    altColor,\n    concreteDimensions,\n    containerStyle: flatStyle,\n    initialDimensions,\n    objectFit,\n    onError,\n    source: nomalizedSource\n  });\n}","map":{"version":3,"names":["_react","require","_reactNative","_defaultInitialImageDimensions","_interopRequireDefault","_useIMGNormalizedSource","_useImageConcreteDimensions","_getIMGState","_useImageSpecifiedDimensions","getImageSizeAsync","uri","headers","Promise","onsuccess","onerror","onImageDimensionsSuccess","width","height","Image","getSizeWithHeaders","getSize","useImageNaturalDimensions","props","source","cachedNaturalDimensions","naturalDimensions","setNaturalDimensions","useState","cachedNaturalWidth","cachedNaturalHeight","error","setError","useEffect","resetOnURIChange","onNaturalDimensions","onError","useFetchedNaturalDimensions","hasCachedDimensions","fetchPhysicalDimensions","cancelled","then","dimensions","catch","e","useIMGElementState","alt","altColor","contentWidth","computeMaxWidth","objectFit","initialDimensions","default","flatStyle","specifiedDimensions","nomalizedSource","concreteDimensions","getIMGState","containerStyle"],"sources":["/Users/amelieploil/Desktop/Diploma/kinskyfe/node_modules/react-native-render-html/lib/commonjs/elements/useIMGElementState.ts"],"sourcesContent":["import { useEffect, useState } from 'react';\nimport { Image, ImageURISource } from 'react-native';\nimport {\n  UseIMGElementStateProps,\n  IMGElementState,\n  IncompleteImageDimensions\n} from './img-types';\nimport defaultImageInitialDimensions from './defaultInitialImageDimensions';\nimport useIMGNormalizedSource from './useIMGNormalizedSource';\nimport { ImageDimensions } from '../shared-types';\nimport useImageConcreteDimensions from './useImageConcreteDimensions';\nimport { getIMGState } from './getIMGState';\nimport useImageSpecifiedDimensions from './useImageSpecifiedDimensions';\n\nfunction getImageSizeAsync({\n  uri,\n  headers\n}: {\n  headers: any;\n  uri: string;\n}): Promise<ImageDimensions> {\n  return new Promise<ImageDimensions>((onsuccess, onerror) => {\n    const onImageDimensionsSuccess = (width: number, height: number) =>\n      onsuccess({ width, height });\n    if (headers) {\n      Image.getSizeWithHeaders(uri, headers, onImageDimensionsSuccess, onerror);\n    } else {\n      Image.getSize(uri, onImageDimensionsSuccess, onerror);\n    }\n  });\n}\n\nfunction useImageNaturalDimensions<P extends UseIMGElementStateProps>(props: {\n  cachedNaturalDimensions?: ImageDimensions;\n  source: ImageURISource;\n  specifiedDimensions: IncompleteImageDimensions;\n}) {\n  const { source, cachedNaturalDimensions } = props;\n  const [naturalDimensions, setNaturalDimensions] = useState<\n    P['cachedNaturalDimensions'] extends ImageDimensions\n      ? ImageDimensions\n      : ImageDimensions | null\n  >((cachedNaturalDimensions as any) || null);\n  const { width: cachedNaturalWidth, height: cachedNaturalHeight } =\n    cachedNaturalDimensions || {};\n  const [error, setError] = useState<null | Error>(null);\n  useEffect(\n    function resetOnURIChange() {\n      setNaturalDimensions(\n        (cachedNaturalWidth != null && cachedNaturalHeight != null\n          ? { width: cachedNaturalWidth, height: cachedNaturalHeight }\n          : null) as any\n      );\n      setError(null);\n    },\n    [cachedNaturalHeight, cachedNaturalWidth, source.uri]\n  );\n  return {\n    onNaturalDimensions: setNaturalDimensions,\n    onError: setError,\n    naturalDimensions,\n    error\n  };\n}\n\nfunction useFetchedNaturalDimensions(props: {\n  cachedNaturalDimensions?: ImageDimensions;\n  source: ImageURISource;\n  specifiedDimensions: IncompleteImageDimensions;\n}) {\n  const { source, cachedNaturalDimensions } = props;\n  const { error, naturalDimensions, onError, onNaturalDimensions } =\n    useImageNaturalDimensions(props);\n  const hasCachedDimensions = !!cachedNaturalDimensions;\n  useEffect(\n    function fetchPhysicalDimensions() {\n      let cancelled = false;\n      if (source.uri && !hasCachedDimensions) {\n        getImageSizeAsync({ uri: source.uri, headers: source.headers })\n          .then((dimensions) => !cancelled && onNaturalDimensions(dimensions))\n          .catch((e) => !cancelled && onError(e || {}));\n        return () => {\n          cancelled = true;\n        };\n      }\n    },\n    [\n      source.uri,\n      source.headers,\n      onNaturalDimensions,\n      onError,\n      hasCachedDimensions\n    ]\n  );\n  return {\n    naturalDimensions,\n    error,\n    onError,\n    onNaturalDimensions\n  };\n}\n\n/**\n * This hook will compute concrete dimensions from image natural dimensions and\n * constraints. It will fetch the image and get its dimensions.\n *\n * @remarks If you know the dimensions beforehand, use\n * {@link useIMGElementStateWithCache} instead to save a network request and\n * prevent a layout shift.\n */\nexport default function useIMGElementState(\n  props: UseIMGElementStateProps\n): IMGElementState {\n  const {\n    alt,\n    altColor,\n    source,\n    contentWidth,\n    computeMaxWidth,\n    objectFit,\n    initialDimensions = defaultImageInitialDimensions,\n    cachedNaturalDimensions\n  } = props;\n  const { flatStyle, specifiedDimensions } = useImageSpecifiedDimensions(props);\n  const nomalizedSource = useIMGNormalizedSource({\n    specifiedDimensions,\n    source\n  });\n  const { naturalDimensions, onError, error } = useFetchedNaturalDimensions({\n    source: nomalizedSource,\n    specifiedDimensions,\n    cachedNaturalDimensions\n  });\n  const concreteDimensions = useImageConcreteDimensions({\n    flatStyle,\n    naturalDimensions,\n    specifiedDimensions,\n    computeMaxWidth,\n    contentWidth\n  });\n\n  return getIMGState({\n    error,\n    alt,\n    altColor,\n    concreteDimensions,\n    containerStyle: flatStyle,\n    initialDimensions,\n    objectFit,\n    onError,\n    source: nomalizedSource\n  });\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}