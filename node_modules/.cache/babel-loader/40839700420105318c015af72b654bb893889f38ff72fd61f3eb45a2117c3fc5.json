{"ast":null,"code":"\"use strict\";\n\nvar _objectSpread = require(\"/Users/amelieploil/Desktop/Diploma/kinskyfe/node_modules/@babel/runtime/helpers/objectSpread2.js\").default;\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.mapNodeList = mapNodeList;\nexports.bindChildren = bindChildren;\nexports.translateNode = translateNode;\nexports.translateDocument = translateDocument;\nvar _TTextCtor = require(\"../tree/TTextCtor\");\nvar _TPhrasingCtor = require(\"../tree/TPhrasingCtor\");\nvar _TBlockCtor = require(\"../tree/TBlockCtor\");\nvar _TDocumentImpl = require(\"../tree/TDocumentImpl\");\nvar _domUtils = require(\"../dom/dom-utils\");\nvar _TEmptyCtor = require(\"../tree/TEmptyCtor\");\nfunction mapNodeList(_ref) {\n  let {\n    nodeList,\n    parent,\n    parentStyles,\n    params\n  } = _ref;\n  const nextMap = [];\n  for (const i in nodeList) {\n    const child = nodeList[i];\n    const translated = translateNode({\n      node: child,\n      parentStyles,\n      params,\n      nodeIndex: Number(i),\n      parent\n    });\n    if (translated) {\n      nextMap.push(translated);\n    }\n  }\n  return nextMap;\n}\nfunction bindChildren(node, children, params) {\n  if (!node.elementModel || !node.elementModel.isOpaque) {\n    node.bindChildren(mapNodeList({\n      nodeList: children,\n      parent: node,\n      params\n    }));\n  }\n}\nfunction translateElement(_ref2) {\n  let {\n    node,\n    nodeIndex,\n    params,\n    parent,\n    parentStyles\n  } = _ref2;\n  const tagName = node.tagName;\n  const sharedProps = {\n    nodeIndex,\n    parentStyles,\n    context: params,\n    domNode: node,\n    parent\n  };\n  const elementModel = params.modelRegistry.getElementModelFromTagName(tagName);\n  if (!elementModel) {\n    return new _TEmptyCtor.TEmptyCtor(_objectSpread(_objectSpread({}, sharedProps), {}, {\n      isUnregistered: true,\n      elementModel,\n      domNode: node\n    }));\n  }\n  if (elementModel.isTranslatableTextual()) {\n    if (node.children.length === 1) {\n      const child = node.children[0];\n      if ((0, _domUtils.isDomText)(child)) {\n        return new _TTextCtor.TTextCtor(_objectSpread(_objectSpread({}, sharedProps), {}, {\n          elementModel,\n          textNode: child,\n          domNode: node\n        }));\n      }\n    } else if (node.children.length === 0) {\n      return new _TTextCtor.TTextCtor(_objectSpread(_objectSpread({}, sharedProps), {}, {\n        elementModel,\n        domNode: node,\n        textNode: new _domUtils.Text('')\n      }));\n    }\n    const phrasing = new _TPhrasingCtor.TPhrasingCtor(_objectSpread(_objectSpread({}, sharedProps), {}, {\n      domNode: node,\n      elementModel\n    }));\n    bindChildren(phrasing, node.children, params);\n    return phrasing;\n  }\n  if (elementModel.isTranslatableBlock()) {\n    const block = new _TBlockCtor.TBlockCtor(_objectSpread(_objectSpread({}, sharedProps), {}, {\n      elementModel,\n      parentStyles,\n      domNode: node\n    }));\n    bindChildren(block, node.children, params);\n    return block;\n  }\n  return new _TEmptyCtor.TEmptyCtor(_objectSpread(_objectSpread({}, sharedProps), {}, {\n    isUnregistered: false,\n    elementModel,\n    domNode: node\n  }));\n}\nfunction translateNode(_ref3) {\n  let {\n    node,\n    parentStyles,\n    params,\n    nodeIndex,\n    parent\n  } = _ref3;\n  if ((0, _domUtils.isDomText)(node)) {\n    return new _TTextCtor.TTextCtor({\n      textNode: node,\n      context: params,\n      parentStyles,\n      domNode: null,\n      elementModel: null,\n      nodeIndex,\n      parent\n    });\n  }\n  if ((0, _domUtils.isDomElement)(node)) {\n    return translateElement({\n      node,\n      parentStyles,\n      params,\n      nodeIndex,\n      parent\n    });\n  }\n  return null;\n}\nfunction translateDocument(document, params) {\n  const tdoc = new _TDocumentImpl.TDocumentCtor({\n    context: params,\n    styles: params.baseStyles,\n    domNode: document\n  });\n  bindChildren(tdoc, document.children, params);\n  tdoc.parseChildren();\n  return tdoc;\n}","map":{"version":3,"names":["_TTextCtor","require","_TPhrasingCtor","_TBlockCtor","_TDocumentImpl","_domUtils","_TEmptyCtor","mapNodeList","_ref","nodeList","parent","parentStyles","params","nextMap","i","child","translated","translateNode","node","nodeIndex","Number","push","bindChildren","children","elementModel","isOpaque","translateElement","_ref2","tagName","sharedProps","context","domNode","modelRegistry","getElementModelFromTagName","TEmptyCtor","_objectSpread","isUnregistered","isTranslatableTextual","length","isDomText","TTextCtor","textNode","Text","phrasing","TPhrasingCtor","isTranslatableBlock","block","TBlockCtor","_ref3","isDomElement","translateDocument","document","tdoc","TDocumentCtor","styles","baseStyles","parseChildren"],"sources":["/Users/amelieploil/Desktop/Diploma/kinskyfe/node_modules/@native-html/transient-render-engine/lib/commonjs/flow/translate.ts"],"sourcesContent":["import { TNodeImpl, TNodeInit } from '../tree/tree-types';\nimport { Document } from 'domhandler';\nimport { TTextCtor } from '../tree/TTextCtor';\nimport { TPhrasingCtor } from '../tree/TPhrasingCtor';\nimport { TBlockCtor } from '../tree/TBlockCtor';\nimport { TDocumentCtor, TDocumentImpl } from '../tree/TDocumentImpl';\nimport { isDomElement, isDomText, Element, Node, Text } from '../dom/dom-utils';\nimport { TStyles } from '../styles/TStyles';\n\nimport { TEmptyCtor } from '../tree/TEmptyCtor';\nimport { DataFlowParams } from './types';\n\nexport function mapNodeList({\n  nodeList,\n  parent,\n  parentStyles,\n  params\n}: {\n  nodeList: Node[];\n  parentStyles?: TStyles;\n  parent: TNodeImpl | null;\n  params: DataFlowParams;\n}): TNodeImpl[] {\n  const nextMap: TNodeImpl[] = [];\n  for (const i in nodeList) {\n    const child = nodeList[i];\n    const translated = translateNode({\n      node: child,\n      parentStyles,\n      params,\n      nodeIndex: Number(i),\n      parent\n    });\n    if (translated) {\n      nextMap.push(translated);\n    }\n  }\n  return nextMap;\n}\n\nexport function bindChildren(\n  node: TNodeImpl,\n  children: Node[],\n  params: DataFlowParams\n) {\n  if (!node.elementModel || !node.elementModel.isOpaque) {\n    node.bindChildren(\n      mapNodeList({\n        nodeList: children,\n        parent: node,\n        params\n      })\n    );\n  }\n}\n\nfunction translateElement({\n  node,\n  nodeIndex,\n  params,\n  parent,\n  parentStyles\n}: TranslateParams<Element>): TNodeImpl | null {\n  const tagName = node.tagName;\n  const sharedProps: Omit<TNodeInit, 'contentModel' | 'elementModel'> = {\n    nodeIndex,\n    parentStyles,\n    context: params,\n    domNode: node,\n    parent\n  };\n  const elementModel = params.modelRegistry.getElementModelFromTagName(tagName);\n  if (!elementModel) {\n    return new TEmptyCtor({\n      ...sharedProps,\n      isUnregistered: true,\n      elementModel,\n      domNode: node\n    });\n  }\n  if (elementModel.isTranslatableTextual()) {\n    if (node.children.length === 1) {\n      const child = node.children[0] as Node;\n      if (isDomText(child)) {\n        return new TTextCtor({\n          ...sharedProps,\n          elementModel,\n          textNode: child,\n          domNode: node\n        });\n      }\n    } else if (node.children.length === 0) {\n      return new TTextCtor({\n        ...sharedProps,\n        elementModel,\n        domNode: node,\n        textNode: new Text('')\n      });\n    }\n    const phrasing = new TPhrasingCtor({\n      ...sharedProps,\n      domNode: node,\n      elementModel\n    });\n    bindChildren(phrasing, node.children, params);\n    return phrasing;\n  }\n  if (elementModel.isTranslatableBlock()) {\n    const block = new TBlockCtor({\n      ...sharedProps,\n      elementModel,\n      parentStyles,\n      domNode: node\n    });\n    bindChildren(block, node.children, params);\n    return block;\n  }\n  return new TEmptyCtor({\n    ...sharedProps,\n    isUnregistered: false,\n    elementModel,\n    domNode: node\n  });\n}\n\ninterface TranslateParams<T = Node> {\n  node: T;\n  params: DataFlowParams;\n  parent: TNodeImpl | null;\n  parentStyles?: TStyles;\n  nodeIndex?: number;\n}\n\nexport function translateNode({\n  node,\n  parentStyles,\n  params,\n  nodeIndex,\n  parent\n}: TranslateParams<Node | null>): TNodeImpl | null {\n  if (isDomText(node)) {\n    return new TTextCtor({\n      textNode: node,\n      context: params,\n      parentStyles,\n      domNode: null,\n      elementModel: null,\n      nodeIndex,\n      parent\n    });\n  }\n  if (isDomElement(node)) {\n    return translateElement({\n      node,\n      parentStyles,\n      params,\n      nodeIndex,\n      parent\n    });\n  }\n  return null;\n}\n\nexport function translateDocument(\n  document: Document,\n  params: DataFlowParams\n): TDocumentImpl {\n  const tdoc = new TDocumentCtor({\n    context: params,\n    styles: params.baseStyles,\n    domNode: document as any\n  });\n  bindChildren(tdoc, document.children, params);\n  tdoc.parseChildren();\n  return tdoc;\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}